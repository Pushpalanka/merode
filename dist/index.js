"use strict";
var express = require("express");
var bodyParser = require("body-parser");
var config_1 = require("./config/config");
var player = require("./api/player");
var user = require("./api/user");
var app = express();
var mongoose = require('mongoose');
mongoose.connect(config_1.Config.current.mongoConnectionString);
if (config_1.Config.env == 'development') {
    app.use(function (req, res, next) {
        res.header("Access-Control-Allow-Origin", "*");
        res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
        next();
    });
}
;
app.use('/', express.static(config_1.Config.current.root + '/public'));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({
    extended: true
}));
player.players(app);
user.users(app);
app.use(function (req, res, next) {
    var err = new Error('Not Found');
    err.status = 404;
    next(err);
});
app.use(function (err, res, next) {
    res.status(err.status || 500);
    res.render('error', {
        message: err.message,
        error: err,
        title: 'error'
    });
});
var server = app.listen(config_1.Config.current.port, function () {
    console.log('Server listening on port' + config_1.Config.current.port);
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFZLE9BQU8sV0FBTSxTQUFTLENBQUMsQ0FBQTtBQUNuQyxJQUFZLFVBQVUsV0FBTSxhQUM1QixDQUFDLENBRHdDO0FBQ3pDLHVCQUF1QixpQkFDdkIsQ0FBQyxDQUR1QztBQUN4QyxJQUFZLE1BQU0sV0FBTSxjQUFjLENBQUMsQ0FBQTtBQUN2QyxJQUFZLElBQUksV0FBTSxZQUV0QixDQUFDLENBRmlDO0FBRWxDLElBQUksR0FBRyxHQUFHLE9BQU8sRUFBRSxDQUFDO0FBRXBCLElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNuQyxRQUFRLENBQUMsT0FBTyxDQUFDLGVBQU0sQ0FBQyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQztBQUd2RCxFQUFFLENBQUMsQ0FBQyxlQUFNLENBQUMsR0FBRyxJQUFJLGFBQWEsQ0FBQyxDQUFBLENBQUM7SUFDN0IsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFTLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSTtRQUMvQixHQUFHLENBQUMsTUFBTSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQy9DLEdBQUcsQ0FBQyxNQUFNLENBQUMsOEJBQThCLEVBQUUsZ0RBQWdELENBQUMsQ0FBQztRQUM3RixJQUFJLEVBQUUsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUFBLENBQUM7QUFFRixHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLGVBQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDOUQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUMzQixHQUFHLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUM7SUFDMUIsUUFBUSxFQUFFLElBQUk7Q0FDakIsQ0FBQyxDQUFDLENBQUM7QUFFSixNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3BCLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFFaEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSTtJQUM1QixJQUFJLEdBQUcsR0FBRyxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNqQyxHQUFHLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztJQUNqQixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDWixDQUFDLENBQUMsQ0FBQztBQUVMLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxHQUFTLEVBQUUsR0FBRyxFQUFFLElBQUk7SUFDbEMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDO0lBQzlCLEdBQUcsQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFO1FBQ3BCLE9BQU8sRUFBRSxHQUFHLENBQUMsT0FBTztRQUNwQixLQUFLLEVBQUUsR0FBRztRQUNWLEtBQUssRUFBRSxPQUFPO0tBQ2IsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLE1BQU0sR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLGVBQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFO0lBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLEdBQUcsZUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNsRSxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmltcG9ydCAqIGFzIGJvZHlQYXJzZXIgZnJvbSBcImJvZHktcGFyc2VyXCJcbmltcG9ydCB7IENvbmZpZyB9IGZyb20gXCIuL2NvbmZpZy9jb25maWdcIlxuaW1wb3J0ICogYXMgcGxheWVyIGZyb20gXCIuL2FwaS9wbGF5ZXJcIjtcbmltcG9ydCAqIGFzIHVzZXIgZnJvbSBcIi4vYXBpL3VzZXJcIlxuXG52YXIgYXBwID0gZXhwcmVzcygpO1xuXG52YXIgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xubW9uZ29vc2UuY29ubmVjdChDb25maWcuY3VycmVudC5tb25nb0Nvbm5lY3Rpb25TdHJpbmcpO1xuXG5cbmlmIChDb25maWcuZW52ID09ICdkZXZlbG9wbWVudCcpe1xuICAgIGFwcC51c2UoZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHtcbiAgICByZXMuaGVhZGVyKFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luXCIsIFwiKlwiKTtcbiAgICByZXMuaGVhZGVyKFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiLCBcIk9yaWdpbiwgWC1SZXF1ZXN0ZWQtV2l0aCwgQ29udGVudC1UeXBlLCBBY2NlcHRcIik7XG4gICAgbmV4dCgpO1xuICAgIH0pO1xufTtcblxuYXBwLnVzZSgnLycsIGV4cHJlc3Muc3RhdGljKENvbmZpZy5jdXJyZW50LnJvb3QgKyAnL3B1YmxpYycpKTtcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpO1xuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoe1xuICAgIGV4dGVuZGVkOiB0cnVlXG59KSk7XG5cbnBsYXllci5wbGF5ZXJzKGFwcCk7XG51c2VyLnVzZXJzKGFwcCk7XG5cbmFwcC51c2UoZnVuY3Rpb24gKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcignTm90IEZvdW5kJyk7XG4gICAgZXJyLnN0YXR1cyA9IDQwNDtcbiAgICBuZXh0KGVycik7XG4gIH0pO1xuXG5hcHAudXNlKGZ1bmN0aW9uIChlcnI6RXJyb3IsIHJlcywgbmV4dCkge1xuICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApO1xuICAgIHJlcy5yZW5kZXIoJ2Vycm9yJywge1xuICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlLFxuICAgIGVycm9yOiBlcnIsXG4gICAgdGl0bGU6ICdlcnJvcidcbiAgICB9KTtcbn0pO1xuXG52YXIgc2VydmVyID0gYXBwLmxpc3RlbihDb25maWcuY3VycmVudC5wb3J0LCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5sb2coJ1NlcnZlciBsaXN0ZW5pbmcgb24gcG9ydCcgKyBDb25maWcuY3VycmVudC5wb3J0KTtcbn0pO1xuXG5pbnRlcmZhY2UgRXJyb3Ige1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgc3RhdHVzOm51bWJlcjtcbn1cblxuaW50ZXJmYWNlIEVycm9yQ29uc3RydWN0b3Ige1xuICAgIG5ldyAobWVzc2FnZT86IHN0cmluZyk6IEVycm9yO1xuICAgIChtZXNzYWdlPzogc3RyaW5nKTogRXJyb3I7XG4gICAgcHJvdG90eXBlOiBFcnJvcjtcbn1cblxuZGVjbGFyZSB2YXIgRXJyb3I6IEVycm9yQ29uc3RydWN0b3I7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
